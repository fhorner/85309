y.scale = "continuous",
seed = 1000)
summary_modmed(results_c)
summary_modmed(results)
summary(lm(t3a1c ~ appr, data = finalcc))
summary(lm(t3a1c ~ collab, data = finalcc))
summary(lm(t3a1c ~ collab*appr, data = finalcc))
summary(lm(t3a1c ~ collab*appr + t1a1c, data = finalcc))
summary(lm(t3a1c ~ collab + t1a1c, data = finalcc))
summary(lm(t3a1c ~ appr + t1a1c, data = finalcc))
start <- Sys.time()
sens.results.c=modmed.sens(object=results_c,
sens.effect = c("TIE.ref", "TIE.dif"),
range.b.m=NULL,
range.b.y=NULL,
grid.b.m = 5,
grid.b.y = 5,
U.scale="binary",
p.u=0.5,
t.rand=TRUE,
t.model=NULL,
iter = 10,
nsim = 5,
ncore = 7)
end <- Sys.time()
runTime = end-start
runTime
sens.plot(object = results_c, sens.results = sens.results.c,effect="TIE.ref")
sens.plot(object = results_c, sens.results = sens.results.c,effect="TIE.dif")
setwd("~/Documents/Classes/EDUC3418/FinalProj/CC_A1c")
choiceBL6 <- read_sav("data/choice_BL_6mo_6.19.20.sav") %>%
select(respid,
#pre-treat controls
d1Hba1c, d1sex, d1educr, ffvickiimpute, d1wrkstat, p1marstat,
avemarlength, p1kids, d1comb, yrssincediag, insulin,
#treatment
d1ccappr, d1cccollab,
#mediator
d2slfeff,
#moderator
d1racewhbl)
library(tidyverse)
choiceBL6 <- read_sav("data/choice_BL_6mo_6.19.20.sav") %>%
select(respid,
#pre-treat controls
d1Hba1c, d1sex, d1educr, ffvickiimpute, d1wrkstat, p1marstat,
avemarlength, p1kids, d1comb, yrssincediag, insulin,
#treatment
d1ccappr, d1cccollab,
#mediator
d2slfeff,
#moderator
d1racewhbl)
library(haven)
library(tidyverse)
choiceBL6 <- read_sav("data/choice_BL_6mo_6.19.20.sav") %>%
select(respid,
#pre-treat controls
d1Hba1c, d1sex, d1educr, ffvickiimpute, d1wrkstat, p1marstat,
avemarlength, p1kids, d1comb, yrssincediag, insulin,
#treatment
d1ccappr, d1cccollab,
#mediator
d2slfeff,
#moderator
d1racewhbl)
DSE$qdsdsca
DSE <- read_sav("data/DSE_BL_returnsamp_1.25.24.sav") #%>%
choiceBL6 <- read_sav("data/choice_BL_6mo_6.19.20.sav") #%>%
View(choiceBL6)
choiceBL6 <- read_sav("data/choice_BL_6mo_6.19.20.sav") %>%
select(respid,
#pre-treat controls
d1Hba1c, d1sex, d1educr, ffvickiimpute, d1wrkstat, p1marstat,
avemarlength, p1kids, d1comb, yrssincediag, insulin,
#treatment
d1ccappr, d1cccollab,
#mediator
d2slfeff,
d2marqual,
#moderator
d1racewhbl)
DSE <- read_sav("data/DSE_BL_returnsamp_1.25.24.sav") %>%
select(respid, qda1c,
sdsca
) #outcome
ccdata <- left_join(choiceBL6, DSE, by = "respid")
ccdata <- ccdata %>%
rename(t1a1c = d1Hba1c,
female = d1sex,                #cat
educr = d1educr,            #cat
income = ffvickiimpute,     #can treat as cont
wrkstat = d1wrkstat,        #cat
marstat = p1marstat,        #cat
rellength = avemarlength,   #cont
kids = p1kids,              #cat
comorb = d1comb,            #continuous -- # of comorbidities
yrsdiag = yrssincediag,
appr = d1ccappr,
collab = d1cccollab,
t2selfeff = d2slfeff,
race = d1racewhbl,
t3a1c = qda1c)
ccdata <- ccdata %>%
select(respid, appr, collab, t2selfeff, t3a1c,
everything()) %>%
mutate(female = as.factor(if_else(female == 1, 0, 1)),
wrkstat = as.factor(wrkstat-1),
marstat = as.factor(marstat-1),
kids = as.factor(kids - 1),
insulin = as.factor(insulin),
race = as.factor(race - 1))
#counting NAs
missing <- ccdata %>%
summarize_all(~ sum(is.na(.)))
View(missing)
View(DSE)
DSE <- read_sav("data/DSE_BL_returnsamp_1.25.24.sav") %>%
select(respid, qda1c,
qdsdsca
) #outcome
ccdata <- left_join(choiceBL6, DSE, by = "respid")
ccdata <- ccdata %>%
rename(t1a1c = d1Hba1c,
female = d1sex,                #cat
educr = d1educr,            #cat
income = ffvickiimpute,     #can treat as cont
wrkstat = d1wrkstat,        #cat
marstat = p1marstat,        #cat
rellength = avemarlength,   #cont
kids = p1kids,              #cat
comorb = d1comb,            #continuous -- # of comorbidities
yrsdiag = yrssincediag,
appr = d1ccappr,
collab = d1cccollab,
t2selfeff = d2slfeff,
race = d1racewhbl,
t3a1c = qda1c)
ccdata <- ccdata %>%
select(respid, appr, collab, t2selfeff, t3a1c,
everything()) %>%
mutate(female = as.factor(if_else(female == 1, 0, 1)),
wrkstat = as.factor(wrkstat-1),
marstat = as.factor(marstat-1),
kids = as.factor(kids - 1),
insulin = as.factor(insulin),
race = as.factor(race - 1))
#counting NAs
missing <- ccdata %>%
summarize_all(~ sum(is.na(.)))
View(missing)
finalcc <- ccdata %>%
filter(is.na(t3a1c) == FALSE)
finalMiss <- finalcc %>%
summarize_all(~ sum(is.na(.)))
#bin treatments
finalcc <- finalcc %>%
mutate(appr_med = median(appr),
appr_bin = as.factor(if_else(appr > appr_med, 1, 0)),
collab_med = median(collab),
collab_bin = as.factor(if_else(appr > appr_med, 1, 0)))
View(finalMiss)
write_csv(finalcc, "finalcc.csv")
results_a = modmed(data=finalcc,
treatment="appr_bin",
mediator= "d2marqual" #"t2selfeff",
outcome="t3a1c",
results_a = modmed(data=finalcc,
treatment="appr_bin",
mediator= "d2marqual", #"t2selfeff",
outcome="t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
View(finalcc)
finalcc <- finalcc %>%
mutate(d2marqual = if_else(is.na(d2marqual), mean(d2marqual), d2marqual))
View(finalcc)
finalMiss <- finalcc %>%
summarize_all(~ sum(is.na(.)))
View(finalMiss)
finalMiss <- finalcc %>%
summarize_all(~ sum(is.na(.)))
View(finalMiss)
mean(finalcc$d2marqual)
finalcc <- finalcc %>%
mutate(d2marqual = if_else(is.na(d2marqual), mean(d2marqua, na.rm = T), d2marqual))
finalcc <- finalcc %>%
mutate(d2marqual = if_else(is.na(d2marqual), mean(d2marqual, na.rm = T), d2marqual))
finalMiss <- finalcc %>%
summarize_all(~ sum(is.na(.)))
View(finalMiss)
#bin treatments
finalcc <- finalcc %>%
mutate(appr_med = median(appr),
appr_bin = as.factor(if_else(appr > appr_med, 1, 0)),
collab_med = median(collab),
collab_bin = as.factor(if_else(appr > appr_med, 1, 0)))
write_csv(finalcc, "finalcc.csv")
results_a = modmed(data=finalcc,
treatment="appr_bin",
mediator= "d2marqual", #"t2selfeff",
outcome="t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
results_a = modmed(data=finalcc,
treatment="appr_bin",
mediator= "t2selfeff",
outcome="t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
detach("package:haven", unload = TRUE)
results_a = modmed(data = finalcc,
treatment = "appr_bin",
mediator = "t2selfeff",
outcome = "t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
setwd("/Users/fiona/Documents/Classes/EDUC3418/FinalProj/CC_A1c")
library(tidyverse)
library(mediation)
library(moderate.mediation)
finalcc <- read.csv("finalcc.csv")
results_a = modmed(data = finalcc,
treatment = "appr_bin",
mediator = "t2selfeff",
outcome = "t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
results_a = modmed(data = finalcc,
treatment = "appr_bin",
mediator = "d2marqual",
outcome = "t3a1c",
covariates.disc = c("female","educr",
"wrkstat","marstat", "kids",
"insulin"),
covariates.cont = c("t1a1c", "income", "rellength", "yrsdiag"),
moderators.disc = "race",
moderators.cont = NULL,
m.model=list(intercept="race", treatment="race",
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL,
income = NULL, rellength = NULL, yrsdiag = NULL),
y.model=list(intercept = "race", treatment = "race",
mediator ="race",
tm="race", #interaction term
female = NULL, educr = NULL, wrkstat = NULL,
marstat = NULL, kids = NULL, insulin = NULL,
t1a1c = NULL, income = NULL,
rellength = NULL, yrsdiag = NULL),
comp.treatment.value = 1,
ref.treatment.value = 0,
comp.mod.disc.values = 1,
ref.mod.disc.values = 0,
comp.mod.cont.values = NULL,
ref.mod.cont.values = NULL,
m.scale = "continuous",
y.scale = "continuous",
seed = 1000)
summary_modmed(results_a)
setwd("~/Documents/Classes/85309-Example/Tutorials")
library(tidyverse)
dat.mariokart<-read.csv("https://raw.githubusercontent.com/jrasero/cm-85309-2023/main/datasets/mariokart_ebay.csv")
dat.mariokart$cond<-as.factor(dat.mariokart$cond)
dat.mariokart$cond<-relevel(dat.mariokart$cond, ref = "used")
head(dat.mariokart)
#we'll do this together
reg.model.1 <- lm(total_pr ~ stock_photo, data = dat.mariokart)
summary(reg.model.1)
#We'll do this together
reg.model.2 <- lm(total_pr ~ stock_photo + wheels, data = dat.mariokart)
reg.model.3 <- lm(total_pr ~ stock_photo + cond, data = dat.mariokart)
summary(reg.model.2)
summary(reg.model.3)
# Association between "stock_photo" and "cond"
chisq.test(table(dat.mariokart$stock_photo, dat.mariokart$cond))
# Association between "total_pr" and "cond"
t.test(total_pr ~ cond, data = dat.mariokart)
# Association between "stock_photo" and "wheels"
t.test(wheels~ stock_photo, data = dat.mariokart)
# Association between "total_pr" and "wheels"
cor.test(~total_pr + wheels, data = dat.mariokart)
reg.model.full <- lm(total_pr ~ ., data = dat.mariokart)
# reg.model.full <- lm(total_pr ~ duration + n_bids + cond + seller_rate +
#stock_photo + wheels, data = dat.mariokart)
summary(reg.model.full)
reg.model.subset <-lm(total_pr ~ cond + wheels + seller_rate,
data = dat.mariokart)
summary(reg.model.subset)
?anova
# anova(reg.model.subset, reg.model.full)
?anova
anova(reg.model.subset, reg.model.full)
AIC(reg.model.full)
AIC(reg.model.subset)
?step
step(object = reg.model.full,
direction = "backward")
reg.model.null <- lm(total_pr ~ 1, data = dat.mariokart)
#scope is a formula object of most complex model possible
scope <- total_pr ~ cond + wheels + stock_photo +
duration + seller_rate + n_bids
#don't do this:
#total_pr ~ .
#run step:
step(object = reg.model.null,
scope=scope,
direction = "forward")
?step
?fisher.test
gallup_atheism <- read.csv("gallup_atheism.csv")
head(gallup_atheism)
library(tidyverse)
dat.subset <- filter(gallup_atheism, year=="2012" & nationality=="United States"|nationality=="Spain"|nationality=="Finland"|nationality=="France")
head(dat.subset)
library(ggplot2)
ggplot(dat.subset, aes(fill=response, x=nationality)) + geom_bar()
atheism_table <- table(dat.subset$nationality, dat.subset$response)
atheism_table
chisq.test(atheism_table)
atheism_table["Finland", ]
atheism_table["France", ]
atheism_table["Finland", ]
atheism_table["France", ]
#your answer here
gall.dat<- read.csv("gallup_atheism.csv")
library(tidyverse)
#your answer here
dat.subset<- gall.dat %>%
filter(year==2012, nationality %in% c( "United States", "Spain", "Finland", "France"))
head(dat.subset)
#your answer here
ggplot(data= dat.subset, mapping= aes(x=nationality, fill=response))+
geom_bar(position = "fill")+
ylab("proportion")+
stat_count(geom = "text",
aes(label = after_stat(round(100*count / tapply(count, x, sum)[as.character(x)], 2))),
position=position_fill(vjust=0.5),
size=5,
colour="black")
#your answer here
contingency_table<-table(dat.subset$nationality,dat.subset$response)
contingency_table
#your answer here
chisq.test(contingency_table)
table(dat.subset$nationality %in% c("Findland", "Spain"), dat.subset$response)
length(dat.subset$response)
length(dat.subset$nationality %in% c("Finland", "Spain"))
nrow(dat.subset$response)
nrow(dat.subset$nationality %in% c("Finland", "Spain"))
View(dat.subset)
table(dat.subset$nationality %in% c("Findland", "Spain"), dat.subset$response)
dat.subset$nationality %in% c("Finland", "Spain")
shiny::runApp('/Users/fiona/Downloads/MplusPlotsUI')
2 - 18.931848 + 3.104255 + 2.154157
18.931848 + 3.104255 + 2.154157
2 - (18.931848 + 3.104255 + 2.154157)
library(tidyverse)
setwd("~/Documents/TA/2024_85309/85309/finalProj")
data <- read_csv("finalProjSmall.csv")
data <- read_csv("finalProjSmall.csv")
?rowMeans
View(data)
data %>% select(starts_with(q))
data %>% select(starts_with("q"))
data %>% select(Eng_start)
data %>% dplyr::select(starts_with("q"))
dat <- read_csv("finalProjSmall.csv")
dat <- dat %>%
mutate(correct = rowMeans(select(dat, starts_with(q))))
dat <- dat %>%
mutate(correct = rowMeans(dplyr::select(dat, starts_with(q))))
dat <- dat %>%
mutate(correct = rowMeans(dplyr::select(., starts_with(q))))
dat <- dat %>%
mutate(correct = rowMeans(dplyr::select(., starts_with("q"))))
head(dat$correct)
dat <- dat %>%
mutate(correct = rowMeans(dplyr::select(., starts_with("q"))),
logit = log(correct))
ggplot(dat, aes(x = correct)) + geom_histogram()
ggplot(dat, aes(x = logit)) + geom_histogram()
write_csv(dat, "finalProjSmall.csv")
ggplot(dat, aes(x = logit)) + geom_histogram()
dat <- read_csv("finalProjSmall.csv")
head(dat$correct)
head(dat$logit)
